PHP again as its the only thing setup on this laptop and I am on a train.
Format the input rules into an array containing all the before and after values for that value. Then run the inputs through a sort function using the formatted rules to determine that values position in the output.

If input equals the sorted value then it is a correctly sorted line (for part 1). The sorted values for any that dont match go into a seperate array where they are summed up for part 2.
